// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.5/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/assignHelper ../../../../support/arcadeUtils ../../../../arcade/Feature ./visualVariablesUtils".split(" "),function(u,l,p,d,q,r){function t(a,b){if(!a)return null;var m=0,e={};a=a.clone();var c=a.valueExpression,g=a.visualVariables,f=null;if(!a.field&&c){var h="$$fake"+m++,n=d.createFunction(c);e[h]=function(a,f){k.attributes=a.attributes;return d.executeFunction(n,{vars:{$feature:k,$view:d.getViewInfo(f)},spatialReference:b})};a.field=h;a.valueExpression=
null;f=function(a,b){b.attributes[h]=e[h](b);return a.getSymbol(b)}}g&&(a.visualVariables=g.map(function(a){if(a.normalizationField){var f=a.field,h=a.normalizationField,c="$$fake"+m++;e[c]=function(a,b){return a.attributes[f]/a.attributes[h]};a=p({},a);a.field=c;delete a.normalizationField;return a}if(a.valueExpression&&"$view.scale"!==a.valueExpression){var g=a.valueExpression,c="$$fake"+m++,n=d.createFunction(g);e[c]=function(a,f){k.attributes=a.attributes;return d.executeFunction(n,{vars:{$feature:k,
$view:d.getViewInfo(f)},spatialReference:b})};a=p({},a);a.field=c;delete a.valueExpression}return a}));return{renderer:a,normalizingFunctions:e,getSymbolFunction:f}}Object.defineProperty(l,"__esModule",{value:!0});var k=new q(null);l.createRendererInfo=function(a,b){var d=(b=t(a,b)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},b.normalizingFunctions),e=b&&b.getSymbolFunction;a=b&&b.renderer||a;b=null;if("heatmap"===a.type){var c=a.offset;b=9*Math.round(a.blurRadius)+1;b={getIntensity:function(a){return"function"===
typeof a?a:a?"abs"===c?function(b){return Math.abs(b.attributes[a])}:function(b){return b.attributes[a]+c}:function(a){return 1}}(a.field),kernelSize:b,radius:a.blurRadius}}var g=r.convertVisualVariables(a.visualVariables);return{renderer:a,vvFields:g.vvFields,vvRanges:g.vvRanges,heatmapInfo:b,getValue:function(a,b){var c=d[b];return c?c(a):a.attributes[b]},getSymbol:function(a){return e?e(this.renderer,a):this.renderer.getSymbol?this.renderer.getSymbol(a):null}}};l.getSymbol=function(a,b){return a.getSymbol(b)}});