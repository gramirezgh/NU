// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.5/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/HandleRegistry ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../geometry/Point ../support/aaBoundingRect".split(" "),function(n,p,f,d,g,h,k,c,l,m){return function(e){function a(b){b=e.call(this,b)||this;b._updatePromise=null;b._set("center",null);return b}f(a,e);a.prototype.normalizeCtorArgs=function(b){this._set("view",b.view);
return{}};a.prototype.initialize=function(){var b=this;this._handles=new h;this._handles.add(this.watch("surfaceView.extent",function(){return b._update()}));this._handles.add(k.on(this,"surface.layers","change",function(){return b._update()}));this._update()};a.prototype.destroy=function(){this._handles.destroy()};a.prototype._update=function(){var b=this;this._updatePromise&&(this._updatePromise.cancel("cancel"),this._updatePromise=null);if(this.surfaceView){var a=m.center(this.surfaceView.extent),
a=new l(a[0],a[1],this.surfaceView.spatialReference);this.surface&&0<this.surface.layers.length?(this._set("center",null),this._updatePromise=this.surface.queryElevation(a,{noDataValue:0}).then(function(a){b._updatePromise=null;b._set("center",a.geometry)}).otherwise(function(a){"cancel"!==a&&console.error("StableSurfaceCenter failed to update: ",a)})):(a.z=0,this._set("center",a))}else this._set("center",null)};d([c.property({readOnly:!0})],a.prototype,"view",void 0);d([c.property({readOnly:!0,aliasOf:"view.map.ground"})],
a.prototype,"surface",void 0);d([c.property({readOnly:!0,aliasOf:"view.basemapTerrain"})],a.prototype,"surfaceView",void 0);d([c.property({readOnly:!0})],a.prototype,"center",void 0);return a=d([c.subclass("esri.views.3d.terrain.StableSurfaceCenter")],a)}(c.declared(g))});