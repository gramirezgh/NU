// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.5/esri/copyright.txt for details.
//>>built
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/accessorSupport/decorators ../core/Accessor ../core/HandleRegistry".split(" "),function(l,m,g,e,d,h,k){return function(f){function b(){var a=null!==f&&f.apply(this,arguments)||this;a._handles=new k;a._currentTick=0;return a}g(b,f);b.prototype.initialize=function(){var a=this;this.view.allLayerViews.on("after-changes",function(){a.notifyChange("tickInterval");a._handles.remove("layerViewsUpdating");
a._handles.add(a._getLayerViewHandles(),"layerViewsUpdating")});this.watch("tickInterval",function(){return a._restartTicking()});this._restartTicking()};b.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null,this._intervalID&&clearInterval(this._intervalID),this._currentTick=0)};Object.defineProperty(b.prototype,"tickInterval",{get:function(){var a=this.view.allLayerViews.filter(function(a){return null!=a.refresh});return 6E4*this._findCommonDevisorFromLayers(a)},
enumerable:!0,configurable:!0});b.prototype._restartTicking=function(){var a=this;this._currentTick=0;this._intervalID&&clearInterval(this._intervalID);this._intervalID=setInterval(function(){a._currentTick+=a._interval;a.view.allLayerViews.filter(function(a){return!!a.refresh}).forEach(function(b){0===b.refreshInterval%a._currentTick&&b.refresh()})},this._interval)};b.prototype._getLayerViewHandles=function(){var a=this;return this.view.allLayerViews.filter(function(a){return!!a.refresh}).map(function(b){return b.watch("refreshInterval",
function(){return a.notifyChange("tickInterval")})})};b.prototype._findCommonDevisorFromLayers=function(a){var b=function(a,c){return isNaN(a)||isNaN(c)?0:0>=c?a:b(c,a%c)};return a.toArray().reduce(function(a,c){return b(c.refreshInterval,a)},0)};e([d.property()],b.prototype,"view",void 0);e([d.property({readOnly:!0})],b.prototype,"tickInterval",null);return b=e([d.subclass("esri.views.RefreshManager")],b)}(d.declared(h))});